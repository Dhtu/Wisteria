# strace用法

https://blog.csdn.net/qq_33894122/article/details/108187352

strace -cp [pid]

strace -T -e read -p

# zookeeper

sudo /usr/share/zookeeper/bin/zkServer.sh start

# kafka

设置docker网络的listener配置

sudo /usr/share/kafka/bin/kafka-server-start.sh /usr/share/kafka/config/server.properties

/usr/share/kafka/bin/kafka-console-producer.sh --topic tcpconnect --bootstrap-server localhost:9092

/usr/share/kafka/bin/kafka-console-consumer.sh --topic tcpconnect --from-beginning --bootstrap-server localhost:9092

# kde虚拟桌面

ctrl + F1

右键标题栏

# docker


docker run  -it --privileged \
  --name opt \
  -v /lib/modules:/lib/modules:ro \
  -v /sys:/sys:ro \
  -v /usr/src:/usr/src:ro \
  -v /home/thtu/Wisteria:/home/thtu/Wisteria:ro \
  archlinux

  docker start xxxx

docker exec -it --privileged \
  --name opt \
  -v /lib/modules:/lib/modules:ro \
  -v /sys:/sys:ro \
  -v /usr/src:/usr/src:ro \
  -v /home/thtu/Wisteria:/home/thtu/Wisteria:ro \
  w /bin/bash

pacman -S bpf bcc bcc-tools python-bcc python-pip inetutils vim thrift python-thrift

pip3 install kafka-python

bpftool map create /sys/fs/bpf/mnt_ns_set type hash key 8 value 4 entries 128 \
        name mnt_ns_set flags 0


 ./tcpconnect --mntnsmap /sys/fs/bpf/mnt_ns_set &
./src/agent/tps --mntnsmap /sys/fs/bpf/mnt_ns_set &
./hello --mntnsmap /sys/fs/bpf/mnt_ns_set &
./src/agent/tp2s --mntnsmap /sys/fs/bpf/mnt_ns_set &

 cat /etc/hosts #查看ip

# filter
FILE=/sys/fs/bpf/mnt_ns_set
if [ $(printf '\1' | od -dAn) -eq 1 ]; then
 HOST_ENDIAN_CMD=tac
else
  HOST_ENDIAN_CMD=cat
fi

NS_ID_HEX="$(printf '%016x' $(stat -Lc '%i' /proc/self/ns/mnt) | sed 's/.\{2\}/&\n/g' | $HOST_ENDIAN_CMD)"
bpftool map update pinned $FILE key hex $NS_ID_HEX value hex 00 00 00 00 any